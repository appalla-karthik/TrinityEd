{% extends "base.html" %}
{% load static %}

{% block title %}TrinityEd - Home{% endblock %}

{% block extra_head %}
  <!-- Page-specific CSS -->
  <style>
    /* Mac OS inspired styles */
    .mac-window {
      /* existing styles */
      transition: width 0.3s ease, height 0.3s ease, top 0.3s ease, left 0.3s ease, transform 0.3s ease;
      cursor: default;
      user-select: none;
      position: fixed;
      /* start centered */
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90vw;
      max-width: 1200px;
      max-height: 80vh;
      display: none;
      background: linear-gradient(145deg, #f0f0f0, #e0e0e0);
      border-radius: 12px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1), 0 0 0 1px rgba(0,0,0,0.05);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      z-index: 30;
      overflow: hidden;
    }

    .mac-window.maximized {
      top: 0 !important;
      left: 0 !important;
      transform: none !important;
      width: 100vw !important;
      height: 100vh !important;
      max-width: 100vw !important;
      max-height: 100vh !important;
      border-radius: 0 !important;
      box-shadow: none !important;
    }

    .mac-window.minimized {
      display: none !important;
    }

    .mac-window.dragged {
      transition: none; /* Disable transitions during drag */
    }

    .window-header {
      cursor: grab;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      /* existing styles */
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.8);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
    }

    .window-header:hover {
      background: rgba(255, 255, 255, 0.9);
    }

    .window-header:active {
      cursor: grabbing;
    }

    .traffic-lights {
      display: flex;
      gap: 8px;
    }
    
    .traffic-light {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.1s, opacity 0.2s;
      opacity: 0.8;
    }
    
    .traffic-light:hover {
      transform: scale(1.1);
      opacity: 1;
    }

    .traffic-light:active {
      transform: scale(0.95);
    }
    
    .close { background: #ff5f57; }
    .minimize { background: #ffbd2e; }
    .maximize { background: #28ca42; }
    
    .window-title {
      font-size: 13px;
      font-weight: 600;
      color: #333;
      margin: 0 16px;
      flex-grow: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .window-content {
      padding: 20px;
      background: #fff;
      overflow-y: auto; /* Enable vertical scrolling if content overflows */
      max-height: 70vh; /* Limit height to prevent upward overflow */
    }
    
    .mac-section {
      display: none;
      animation: slideIn 0.3s ease-out;
    }
    
    .mac-section.active {
      display: block;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    header h1 {
      background: linear-gradient(to right, #818cf8, #a78bfa, #f472b6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .auth-btn {
      @apply px-6 py-2 rounded-xl font-semibold text-white 
             bg-indigo-600 hover:bg-indigo-500 
             transition shadow-md;
    }
    
    .section-title {
      @apply text-3xl font-bold text-gray-900 mb-6;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .content-section {
      margin-bottom: 0;
      padding: 0;
    }
    
    /* Hide original sections */
    .content-section:not(.intro-section) {
      display: none;
    }
    
    .intro-section {
      display: block;
    }
    
  </style>
{% endblock %}

{% block content %}
  <!-- Animated Background -->
  <canvas id="bgCanvas" class="absolute inset-0 w-full h-full z-0"></canvas>

  <!-- Main Mac Window -->
  <div class="mac-window">
    <!-- Window Header -->
    <div class="window-header">
      <div class="traffic-lights">
        <div class="traffic-light close" title="Close"></div>
        <div class="traffic-light minimize" title="Minimize"></div>
        <div class="traffic-light maximize" title="Maximize"></div>
      </div>
      <h1 class="window-title">TrinityEd - Empowering Education</h1>
      <div></div>
    </div>
    
    <!-- Window Content -->
    <div class="window-content">
      <!-- Header -->
      <header class="text-center mb-12 intro-section content-section">
        <h1 class="text-5xl font-extrabold tracking-tight mb-4">TrinityEd</h1>
        <p class="text-xl text-gray-600 font-medium mb-8">
          Empowering Mentorship & Risk Assessment
        </p>
        <div class="flex justify-center gap-4">
          <a href="/login" class="auth-btn">Login</a>
          <a href="/signup" class="auth-btn">Sign Up</a>
        </div>
      </header>

      <!-- Mission Section -->
      <section id="mission" class="mac-section content-section">
        <h2 class="section-title">Our Mission</h2>
        <p class="text-lg text-gray-700 leading-relaxed mb-6">
          TrinityEd is a simple, affordable tool that brings together student attendance, grades, and fee information to spot students who might be at risk of dropping out. We help teachers and mentors act early to support these students, turning data into helpful alerts that make a real difference in keeping kids in school.
        </p>
        <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-blue-500">
          <p class="text-blue-800 italic">"From scattered spreadsheets to actionable alerts: supporting students, mentors, and parents through early warning signals."</p>
        </div>
      </section>

      <!-- How It Works Section -->
      <section id="how" class="mac-section content-section">
        <h2 class="section-title">How It Works</h2>
        <p class="text-lg text-gray-700 leading-relaxed mb-6">
          TrinityEd makes it easy to keep track of students and help them succeed:
        </p>
        <div class="grid md:grid-cols-2 gap-6">
          <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
            <h3 class="font-semibold text-gray-900 mb-3">1. Gather Information</h3>
            <p class="text-gray-600">It pulls together data on attendance, grades, and fees from your existing records with simple uploads or connections.</p>
          </div>
          <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
            <h3 class="font-semibold text-gray-900 mb-3">2. Spot Issues Early</h3>
            <p class="text-gray-600">Smart analysis identifies patterns that might signal a student is struggling before it becomes a bigger problem.</p>
          </div>
          <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
            <h3 class="font-semibold text-gray-900 mb-3">3. Send Alerts</h3>
            <p class="text-gray-600">Notifications go out to mentors and parents through email or WhatsApp so they can step in quickly when needed.</p>
          </div>
          <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
            <h3 class="font-semibold text-gray-900 mb-3">4. Easy Dashboard</h3>
            <p class="text-gray-600">View clear charts and insights on a user-friendly screen that's simple to navigate and understand.</p>
          </div>
        </div>
      </section>

      <!-- For Mentors Section -->
      <section id="mentors" class="mac-section content-section">
        <h2 class="section-title">For Mentors</h2>
        <p class="text-lg text-gray-700 leading-relaxed mb-6">
          TrinityEd helps mentors support students better with tools designed for real classroom needs:
        </p>
        <div class="space-y-4">
          <div class="flex items-start gap-4 bg-green-50 p-4 rounded-xl border border-green-200">
            <div class="w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"></div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-1">Early Alerts</h3>
              <p class="text-gray-600">Get notifications about students who need help based on their attendance, grades, and fees, so you can act before it's too late.</p>
            </div>
          </div>
          <div class="flex items-start gap-4 bg-blue-50 p-4 rounded-xl border border-blue-200">
            <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"></div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-1">Clear Insights</h3>
              <p class="text-gray-600">Understand why a student might be at risk with straightforward explanations that build trust in the system.</p>
            </div>
          </div>
          <div class="flex items-start gap-4 bg-purple-50 p-4 rounded-xl border border-purple-200">
            <div class="w-2 h-2 bg-purple-500 rounded-full mt-2 flex-shrink-0"></div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-1">Easy to Learn</h3>
              <p class="text-gray-600">The simple design means you can start using it right away without much training or technical knowledge.</p>
            </div>
          </div>
          <div class="flex items-start gap-4 bg-orange-50 p-4 rounded-xl border border-orange-200">
            <div class="w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0"></div>
            <div>
              <h3 class="font-semibold text-gray-900 mb-1">Focused Notifications</h3>
              <p class="text-gray-600">Only get alerts for the most important issues to avoid overload and keep your focus on what matters.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- For Students Section -->
      <section id="students" class="mac-section content-section">
        <h2 class="section-title">For Students</h2>
        <p class="text-lg text-gray-700 leading-relaxed mb-6">
          TrinityEd makes sure students get the help they need to stay on track and succeed:
        </p>
        <div class="grid md:grid-cols-2 gap-6">
          <div class="bg-gradient-to-br from-pink-50 to-purple-50 p-6 rounded-xl border border-pink-200 text-center">
            <div class="w-12 h-12 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-white font-bold text-sm">🎓</span>
            </div>
            <h3 class="font-semibold text-gray-900 mb-2">Quick Support</h3>
            <p class="text-gray-600">Teachers and mentors can spot problems early and offer guidance before things get tough, helping you succeed.</p>
          </div>
          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 text-center">
            <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-white font-bold text-sm">💬</span>
            </div>
            <h3 class="font-semibold text-gray-900 mb-2">Better Communication</h3>
            <p class="text-gray-600">Keeps everyone informed so you receive timely advice, resources, and support when you need it most.</p>
          </div>
          <div class="bg-gradient-to-br from-green-50 to-teal-50 p-6 rounded-xl border border-green-200 text-center">
            <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-teal-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-white font-bold text-sm">🚀</span>
            </div>
            <h3 class="font-semibold text-gray-900 mb-2">Path to Success</h3>
            <p class="text-gray-600">Helps prevent dropouts by addressing issues like low attendance or grades right away, keeping you on track.</p>
          </div>
        </div>
      </section>
    </div>
  </div>
{% endblock %}

{% block extra_js %}
  <!-- Three.js Background -->
 <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>


  <script>
    // === Three.js Background ===
    // === Three.js Background ===
const canvas = document.getElementById("bgCanvas");
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ canvas, alpha: false }); // remove transparency
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setClearColor(0x0a192f, 1); // Dark blue background
// Try 0x0a192f or 0x001f3f for different deep blue tones

// Particles
const particles = new THREE.BufferGeometry();
const count = 3000;
const positions = new Float32Array(count * 3);
for (let i = 0; i < count * 3; i++) {
    positions[i] = (Math.random() - 0.5) * 10;
}
particles.setAttribute("position", new THREE.BufferAttribute(positions, 3));

// Brighter particles for contrast
const material = new THREE.PointsMaterial({ color: 0x66ccff, size: 0.02 });
const points = new THREE.Points(particles, material);
scene.add(points);

camera.position.z = 3;

function animate() {
    requestAnimationFrame(animate);
    points.rotation.y += 0.0008;
    points.rotation.x += 0.0005;
    renderer.render(scene, camera);
}
animate();


    // Resize handler
    window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth/window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Mac Window Interactions with Dock Integration
    document.addEventListener('DOMContentLoaded', function() {
      const dockApps = document.querySelectorAll('.app a');
      const sections = document.querySelectorAll('.mac-section, .intro-section');
      const windowEl = document.querySelector('.mac-window');
      const closeBtn = document.querySelector('.close');
      const minimizeBtn = document.querySelector('.minimize');
      const maximizeBtn = document.querySelector('.maximize');

      let activeSection = null;
      let activeApp = null;
      let windowState = 'closed'; // 'closed', 'normal', 'maximized'
      let isDragging = false;
      let dragOffsetX = 0;
      let dragOffsetY = 0;
      let isDragged = false; // Track if window has been dragged

      // Hide all sections initially
      sections.forEach(section => {
        section.style.display = 'none';
      });
      windowEl.style.display = 'none'; // Start with window closed

      // Helper function to center the window
      function centerWindow() {
        windowEl.style.top = '50%';
        windowEl.style.left = '50%';
        windowEl.style.transform = 'translate(-50%, -50%)';
        windowEl.style.width = '90vw';
        windowEl.style.maxWidth = '1200px';
        windowEl.style.height = 'auto';
        windowEl.style.maxHeight = '80vh';
        windowEl.style.opacity = '1';
        gsap.set(windowEl, { x: 0, y: 0, scale: 1 });
        isDragged = false;
        windowEl.classList.remove('dragged');
      }

      // Helper function to reset window for normal state
      function resetToNormal() {
        windowEl.classList.remove('maximized');
        windowEl.style.opacity = '1';
        windowEl.style.height = 'auto';
        windowEl.style.width = '90vw';
        centerWindow();
      }

      // Dock app click handler
      dockApps.forEach(app => {
        app.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          if (!href.startsWith('#')) {
            return; // Allow default navigation for non-# links like login
          }
          e.preventDefault();
          const targetSection = href.substring(1);
          const parentApp = this.parentElement;

          const isWindowVisible = windowEl.style.display !== 'none';

          if (activeSection === targetSection && isWindowVisible) {
            closeWindow();
          } else if (activeSection === targetSection) {
            openWindow(targetSection, parentApp);
          } else {
            // Different section: switch or open
            if (!isWindowVisible) {
              openWindow(targetSection, parentApp);
            } else {
              switchSection(targetSection, parentApp);
            }
          }
        });
      });

      // Open window from dock
      function openWindow(targetSection, parentApp) {
        // Update active app
        document.querySelectorAll('.app').forEach(a => a.classList.remove('active'));
        parentApp.classList.add('active');
        activeApp = parentApp;

        // Hide all sections
        sections.forEach(section => {
          section.classList.remove('active');
          section.style.display = 'none';
        });

        // Show target section
        const target = document.getElementById(targetSection);
        if (target) {
          target.style.display = 'block';
          gsap.fromTo(target, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.3, ease: "power2.out", onComplete: () => target.classList.add('active') });
        }

        activeSection = targetSection;
        windowState = 'normal';
        windowEl.style.display = 'block';
        resetToNormal();

        // Animate open from dock
        let startX = 0, startY = 0;
        if (activeApp) {
          const iconRect = activeApp.getBoundingClientRect();
          startX = iconRect.left + iconRect.width / 2 - window.innerWidth / 2;
          startY = iconRect.top + iconRect.height / 2 - window.innerHeight / 2;
        }
        gsap.set(windowEl, { x: startX, y: startY, scale: 0.1, opacity: 0 });
        gsap.to(windowEl, {
          x: 0,
          y: 0,
          scale: 1,
          opacity: 1,
          duration: 0.5,
          ease: "power3.out"
        });
      }

      // Switch section in place (no dock animation, just fade)
      function switchSection(targetSection, parentApp) {
        // Update active app if different
        if (activeApp !== parentApp) {
          if (activeApp) activeApp.classList.remove('active');
          parentApp.classList.add('active');
          activeApp = parentApp;
        }

        // Center window first to prevent top-left jump
        centerWindow();

        // Hide all sections
        sections.forEach(section => {
          section.classList.remove('active');
          section.style.display = 'none';
        });

        // Show target section
        const target = document.getElementById(targetSection);
        if (target) {
          target.style.display = 'block';
          gsap.fromTo(target, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 0.3, ease: "power2.out", onComplete: () => target.classList.add('active') });
        }

        activeSection = targetSection;
      }

      // Close window: suck down to dock
      function closeWindow() {
        if (windowState === 'closed') return;

        let endLeft = window.innerWidth / 2;
        let endTop = window.innerHeight;
        if (activeApp) {
          const iconRect = activeApp.getBoundingClientRect();
          endLeft = iconRect.left + iconRect.width / 2;
          endTop = iconRect.top + iconRect.height / 2;
        }

        const tl = gsap.timeline({
          onComplete: () => {
            windowEl.style.display = 'none';
            sections.forEach(section => {
              section.classList.remove('active');
              section.style.display = 'none';
            });
            if (activeApp) {
              activeApp.classList.remove('active');
              activeApp = null;
            }
            activeSection = null;
            windowState = 'closed';
            resetToNormal(); // Reset styles
          }
        });

        tl.to(windowEl, {
          top: endTop,
          height: 0,
          opacity: 0,
          duration: 0.3,
          ease: "power2.in"
        });

        tl.to(windowEl, {
          left: endLeft,
          width: 0,
          duration: 0.1,
          ease: "power1.in"
        });
      }

      // Toggle maximize/restore
      function toggleMaximize() {
        if (windowState === 'closed') return;

        if (windowState === 'maximized') {
          // Restore
          windowState = 'normal';
          windowEl.classList.remove('maximized');
          gsap.to(windowEl, {
            top: '50%',
            left: '50%',
            width: '90vw',
            maxWidth: '1200px',
            height: 'auto',
            maxHeight: '80vh',
            x: 0,
            y: 0,
            scale: 1,
            borderRadius: '12px',
            boxShadow: '0 20px 40px rgba(0,0,0,0.1), 0 0 0 1px rgba(0,0,0,0.05)',
            duration: 0.4,
            ease: "power2.out",
            onComplete: centerWindow
          });
        } else {
          // Maximize
          windowState = 'maximized';
          windowEl.classList.add('maximized');
          gsap.to(windowEl, {
            top: 0,
            left: 0,
            width: '100vw',
            height: '100vh',
            maxWidth: '100vw',
            maxHeight: '100vh',
            x: 0,
            y: 0,
            scale: 1,
            borderRadius: 0,
            boxShadow: 'none',
            duration: 0.4,
            ease: "power2.out"
          });
        }
      }

      // Traffic light buttons with improved feedback
      closeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        closeBtn.style.opacity = '0.5';
        setTimeout(() => { closeBtn.style.opacity = '0.8'; }, 150);
        closeWindow();
      });

      minimizeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        if (windowState !== 'maximized') return;
        minimizeBtn.style.opacity = '0.5';
        setTimeout(() => { minimizeBtn.style.opacity = '0.8'; }, 150);
        // Restore from maximized
        windowState = 'normal';
        windowEl.classList.remove('maximized');
        gsap.to(windowEl, {
          top: '50%',
          left: '50%',
          width: '90vw',
          maxWidth: '1200px',
          height: 'auto',
          maxHeight: '80vh',
          x: 0,
          y: 0,
          scale: 1,
          borderRadius: '12px',
          boxShadow: '0 20px 40px rgba(0,0,0,0.1), 0 0 0 1px rgba(0,0,0,0.05)',
          duration: 0.4,
          ease: "power2.out",
          onComplete: centerWindow
        });
      });

      maximizeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        maximizeBtn.style.opacity = '0.5';
        setTimeout(() => { maximizeBtn.style.opacity = '0.8'; }, 150);
        toggleMaximize();
      });

      // Dragging functionality with safeguards
      const header = windowEl.querySelector('.window-header');

      header.addEventListener('mousedown', (e) => {
        if (windowState === 'maximized' || windowState === 'closed') return;
        isDragging = true;
        isDragged = true;
        windowEl.classList.add('dragged');
        const rect = windowEl.getBoundingClientRect();
        dragOffsetX = e.clientX - rect.left;
        dragOffsetY = e.clientY - rect.top;
        // Switch to absolute positioning for drag
        windowEl.style.transition = 'none';
        windowEl.style.transform = 'none';
        windowEl.style.top = rect.top + 'px';
        windowEl.style.left = rect.left + 'px';
        windowEl.style.width = rect.width + 'px';
        windowEl.style.height = rect.height + 'px';
        windowEl.style.maxWidth = 'none';
        windowEl.style.maxHeight = 'none';
        windowEl.style.cursor = 'grabbing';
        e.preventDefault();
      });

      window.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        let newLeft = e.clientX - dragOffsetX;
        let newTop = e.clientY - dragOffsetY;

        // Constrain to viewport
        const winWidth = windowEl.offsetWidth;
        const winHeight = windowEl.offsetHeight;
        newLeft = Math.max(0, Math.min(newLeft, window.innerWidth - winWidth));
        newTop = Math.max(0, Math.min(newTop, window.innerHeight - winHeight));

        windowEl.style.left = newLeft + 'px';
        windowEl.style.top = newTop + 'px';
      });

      window.addEventListener('mouseup', () => {
        if (isDragging) {
          isDragging = false;
          windowEl.style.cursor = 'default';
          windowEl.classList.remove('dragged');
          windowEl.style.transition = ''; // Re-enable transitions
          // Do not auto-center after drag; only on switch/open/close
        }
      });

      // Double click header to toggle maximize
      header.addEventListener('dblclick', (e) => {
        e.stopPropagation(); 
        toggleMaximize();
      });

      // Handle window resize: re-center if normal state
      window.addEventListener('resize', () => {
        if (windowState === 'normal' && windowEl.style.display !== 'none') {
          centerWindow();
        }
      });
    });
  </script>
{% endblock %}  