{% extends "base.html" %}
{% load static %}

{% block title %}Progress | TrinityEd{% endblock %}

{% block extra_head %}
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: linear-gradient(135deg, #f0faff, #fdfdff, #eaf3ff);
      background-size: 300% 300%;
      animation: gradientShift 12s ease infinite;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .card {
      background: rgba(255,255,255,0.9);
      border-radius: 20px;
      backdrop-filter: blur(12px);
      border: 1px solid rgba(37,99,235,0.15);
      padding: 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover { transform: scale(1.02); box-shadow: 0 12px 32px rgba(37,99,235,0.25); }
  </style>
{% endblock %}

{% block content %}
  <main class=" p-8 animate-fadeIn pb-24">

    <h1 class="text-3xl font-bold text-gray-700 mb-6">üìä Progress Overview</h1>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

      <!-- Attendance Trend -->
      <div class="card">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">Weekly Attendance</h3>
        <canvas id="attendanceChart"></canvas>
      </div>

      <!-- Subject Scores -->
      <div class="card">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">Subject Performance</h3>
        <canvas id="performanceChart"></canvas>
      </div>

      <!-- Risk Score -->
      <div class="card lg:col-span-2">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">Dropout Risk Prediction</h3>
        <div class="flex items-center gap-6">
          <div class="w-40 h-40 relative">
            <canvas id="riskChart"></canvas>
          </div>
          <p class="text-lg text-gray-600">
            Based on your recent attendance & performance, your current 
            <span class="font-bold text-blue-600">Risk Level is Low (15%)</span>. Keep it up! üéâ
          </p>
        </div>
      </div>

      <!-- GPA Progress -->
      <div class="card">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">Overall GPA Progress</h3>
        <div class="w-40 h-40 mx-auto">
          <canvas id="gpaChart"></canvas>
        </div>
        <p class="mt-3 text-center text-gray-600">Your GPA: <span class="font-bold text-green-600">3.6 / 4.0</span></p>
      </div>

      <!-- Risk Radar -->
      <div class="card">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">üì° Risk Radar</h3>
        <canvas id="riskRadar"></canvas>
        <p class="mt-3 text-center text-gray-600 text-sm">
          Visualizing your status across <span class="font-semibold text-blue-600">Attendance, Fees, and Performance</span>
        </p>
      </div>

      <!-- Achievements -->
      <div class="card">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">üèÖ Achievements</h3>
        <ul class="list-disc pl-6 text-gray-600 space-y-2">
          <li>Top 10% in Science Olympiad</li>
          <li>Perfect Attendance in August</li>
          <li>Improved Math score by 15%</li>
        </ul>
      </div>

      <!-- Suggestions -->
      <div class="card">
        <h3 class="text-lg font-semibold mb-4 text-gray-700">üí° Improvement Suggestions</h3>
        <ul class="space-y-2 text-gray-600">
          <li>üìò Revise Algebra before next test</li>
          <li>üß™ Join extra Science practice sessions</li>
          <li>üìñ Read at least 15 mins daily for English</li>
        </ul>
      </div>

    </div>
  </main>
{% endblock %}

{% block extra_js %}
  <script>
    // Attendance Chart
    new Chart(document.getElementById('attendanceChart'), {
      type: 'line',
      data: { labels: ['Mon','Tue','Wed','Thu','Fri'], datasets: [{
        label: 'Attendance %',
        data: [85, 90, 80, 88, 92],
        borderColor: '#2563eb', backgroundColor: 'rgba(37,99,235,0.2)', fill: true, tension: 0.4
      }]},
      options: { scales: { y: { max: 100, beginAtZero: true } } }
    });

    // Performance Chart
    new Chart(document.getElementById('performanceChart'), {
      type: 'bar',
      data: { labels: ['Math','Science','English','History'], datasets: [{
        data: [78, 82, 88, 74], backgroundColor: ['#2563eb','#f59e0b','#dc2626','#16a34a'], borderRadius: 12
      }]},
      options: { scales: { y: { max: 100, beginAtZero: true } } }
    });

    // Risk Chart
    new Chart(document.getElementById('riskChart'), {
      type: 'doughnut',
      data: { labels: ['Risk','Safe'], datasets: [{ data: [15,85], backgroundColor: ['#dc2626','#16a34a'] }] },
      options: { cutout: '70%', plugins: { legend: { display: false } } }
    });

    // GPA Progress
    new Chart(document.getElementById('gpaChart'), {
      type: 'doughnut',
      data: { datasets: [{ data: [90,10], backgroundColor: ['#16a34a','#e5e7eb'] }] },
      options: { cutout: '75%', plugins: { legend: { display: false } } }
    });

    // Risk Radar
    new Chart(document.getElementById('riskRadar'), {
      type: 'radar',
      data: {
        labels: ['Attendance', 'Fees', 'Performance'],
        datasets: [{
          label: 'Student Score',
          data: [85, 90, 78],
          backgroundColor: 'rgba(37,99,235,0.2)',
          borderColor: '#2563eb',
          pointBackgroundColor: '#2563eb',
          borderWidth: 2
        }]
      },
      options: {
        scales: {
          r: {
            angleLines: { color: '#e5e7eb' },
            grid: { color: '#f3f4f6' },
            suggestedMin: 0,
            suggestedMax: 100,
            ticks: { stepSize: 20 }
          }
        },
        plugins: { legend: { display: false } }
      }
    });
  </script>
{% endblock %}
